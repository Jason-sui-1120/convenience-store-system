import{_ as ne}from"./index-398ba06f.js";import{f as T}from"./date-6033e12c.js";/* empty css                             *//* empty css                 *//* empty css                        *//* empty css               *//* empty css               *//* empty css                       */import{a7 as O,Q as ue,a8 as re,a6 as ie,a9 as de,aa as se,ab as pe,Y as r,M as me,ad as ce,ae as _e,an as fe,a5 as be,ag as ge,a4 as ve,a2 as we,am as ye,ao as he,ap as De,al as Ve,af as Ie}from"./element-plus-a4f5b2a7.js";import{r as c,M as q,c as Pe,f as Ce,l as v,m as x,q as w,G as e,A as a,B as Ee,z as Y,u as N,E as o,F as $,W as B}from"./vue-vendor-76d6b13b.js";const qe={class:"inbound-container"},xe={class:"page-header"},Ye={class:"search-bar"},Ne={class:"table-container"},ke={class:"pagination-container"},Fe={class:"dialog-footer"},Me={__name:"inbound",setup(Ue){const D=c(!1),V=c([]),y=c(!1),I=c(!1),h=c(),i=c({}),_=q({productName:"",dateRange:[]}),m=q({page:1,limit:20,total:0}),n=q({productId:"",supplierId:"",quantity:1,purchasePrice:0,inboundDate:new Date().toISOString().split("T")[0],notes:""}),j={productId:[{required:!0,message:"请选择商品",trigger:"change"}],supplierId:[{required:!0,message:"请选择供应商",trigger:"change"}],quantity:[{required:!0,message:"请输入入库数量",trigger:"blur"}],purchasePrice:[{required:!0,message:"请输入采购单价",trigger:"blur"}],inboundDate:[{required:!0,message:"请选择入库日期",trigger:"change"}]},k=c([{_id:"1",name:"景田矿泉水",brand:"景田",specification:"550ml",unit:"瓶",purchasePrice:1.5},{_id:"2",name:"百岁山矿泉水",brand:"百岁山",specification:"570ml",unit:"瓶",purchasePrice:1.8}]),L=c([{_id:"1",name:"景田饮用水供应商"},{_id:"2",name:"百岁山水业"}]),G=Pe(()=>n.quantity*n.purchasePrice),f=async()=>{D.value=!0;try{await new Promise(u=>setTimeout(u,500)),V.value=[{_id:"1",productName:"景田矿泉水",brand:"景田",specification:"550ml",quantity:100,unit:"瓶",purchasePrice:1.5,totalAmount:150,supplierName:"景田饮用水供应商",inboundDate:new Date("2024-01-15"),operator:"admin",notes:"首次进货"},{_id:"2",productName:"百岁山矿泉水",brand:"百岁山",specification:"570ml",quantity:50,unit:"瓶",purchasePrice:1.8,totalAmount:90,supplierName:"百岁山水业",inboundDate:new Date("2024-01-20"),operator:"admin",notes:"补充库存"}],m.total=V.value.length}catch{O.error("获取入库记录失败")}finally{D.value=!1}},Q=u=>{const l=k.value.find(P=>P._id===u);l&&(n.purchasePrice=l.purchasePrice)},F=()=>{},W=()=>{f()},H=()=>{Object.assign(_,{productName:"",dateRange:[]}),f()},J=u=>{m.limit=u,f()},K=u=>{m.page=u,f()},X=async()=>{if(h.value)try{await h.value.validate(),await new Promise(u=>setTimeout(u,500)),O.success("入库成功"),y.value=!1,ee(),f()}catch(u){console.error("表单验证失败:",u)}},Z=u=>{i.value={...u},I.value=!0},ee=()=>{Object.assign(n,{productId:"",supplierId:"",quantity:1,purchasePrice:0,inboundDate:new Date().toISOString().split("T")[0],notes:""}),h.value&&h.value.clearValidate()};return Ce(()=>{f()}),(u,l)=>{const P=me,b=ue,C=ce,s=_e,M=fe,U=re,d=be,te=ie,ae=de,S=Ie,R=ge,g=ve,E=we,z=ye,A=se,p=he,le=De,oe=pe;return v(),x("div",qe,[w("div",xe,[l[15]||(l[15]=w("h2",null,"商品入库",-1)),e(b,{type:"primary",onClick:l[0]||(l[0]=t=>y.value=!0)},{default:a(()=>[e(P,null,{default:a(()=>[e(N(Ve))]),_:1}),l[14]||(l[14]=o(" 新增入库 ",-1))]),_:1,__:[14]})]),w("div",Ye,[e(U,{inline:!0,model:_,class:"search-form"},{default:a(()=>[e(s,{label:"商品名称"},{default:a(()=>[e(C,{modelValue:_.productName,"onUpdate:modelValue":l[1]||(l[1]=t=>_.productName=t),placeholder:"请输入商品名称",clearable:""},null,8,["modelValue"])]),_:1}),e(s,{label:"入库日期"},{default:a(()=>[e(M,{modelValue:_.dateRange,"onUpdate:modelValue":l[2]||(l[2]=t=>_.dateRange=t),type:"daterange","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期",format:"YYYY-MM-DD","value-format":"YYYY-MM-DD"},null,8,["modelValue"])]),_:1}),e(s,null,{default:a(()=>[e(b,{type:"primary",onClick:W},{default:a(()=>l[16]||(l[16]=[o("搜索",-1)])),_:1,__:[16]}),e(b,{onClick:H},{default:a(()=>l[17]||(l[17]=[o("重置",-1)])),_:1,__:[17]})]),_:1})]),_:1},8,["model"])]),w("div",Ne,[Ee((v(),Y(te,{data:V.value,stripe:"",style:{width:"100%"}},{default:a(()=>[e(d,{prop:"productName",label:"商品名称",width:"150"}),e(d,{prop:"brand",label:"品牌",width:"100"}),e(d,{prop:"specification",label:"规格",width:"100"}),e(d,{prop:"quantity",label:"入库数量",width:"100"}),e(d,{prop:"unit",label:"单位",width:"60"}),e(d,{prop:"purchasePrice",label:"采购单价",width:"100"},{default:a(t=>[o(" ¥"+r(t.row.purchasePrice.toFixed(2)),1)]),_:1}),e(d,{prop:"totalAmount",label:"总金额",width:"100"},{default:a(t=>[o(" ¥"+r(t.row.totalAmount.toFixed(2)),1)]),_:1}),e(d,{prop:"supplierName",label:"供应商",width:"120"}),e(d,{prop:"inboundDate",label:"入库日期",width:"120"},{default:a(t=>[o(r(N(T)(t.row.inboundDate)),1)]),_:1}),e(d,{prop:"operator",label:"操作员",width:"100"}),e(d,{prop:"notes",label:"备注","min-width":"120"}),e(d,{label:"操作",width:"100",fixed:"right"},{default:a(t=>[e(b,{size:"small",onClick:Se=>Z(t.row)},{default:a(()=>l[18]||(l[18]=[o("查看",-1)])),_:2,__:[18]},1032,["onClick"])]),_:1})]),_:1},8,["data"])),[[oe,D.value]]),w("div",ke,[e(ae,{"current-page":m.page,"onUpdate:currentPage":l[3]||(l[3]=t=>m.page=t),"page-size":m.limit,"onUpdate:pageSize":l[4]||(l[4]=t=>m.limit=t),"page-sizes":[10,20,50,100],total:m.total,layout:"total, sizes, prev, pager, next, jumper",onSizeChange:J,onCurrentChange:K},null,8,["current-page","page-size","total"])])]),e(A,{modelValue:y.value,"onUpdate:modelValue":l[12]||(l[12]=t=>y.value=t),title:"新增入库",width:"800px"},{footer:a(()=>[w("span",Fe,[e(b,{onClick:l[11]||(l[11]=t=>y.value=!1)},{default:a(()=>l[19]||(l[19]=[o("取消",-1)])),_:1,__:[19]}),e(b,{type:"primary",onClick:X},{default:a(()=>l[20]||(l[20]=[o("确定",-1)])),_:1,__:[20]})])]),default:a(()=>[e(U,{ref_key:"inboundFormRef",ref:h,model:n,rules:j,"label-width":"100px"},{default:a(()=>[e(E,{gutter:20},{default:a(()=>[e(g,{span:12},{default:a(()=>[e(s,{label:"商品",prop:"productId"},{default:a(()=>[e(R,{modelValue:n.productId,"onUpdate:modelValue":l[5]||(l[5]=t=>n.productId=t),placeholder:"请选择商品",filterable:"",style:{width:"100%"},onChange:Q},{default:a(()=>[(v(!0),x($,null,B(k.value,t=>(v(),Y(S,{key:t._id,label:`${t.name} - ${t.brand} (${t.specification})`,value:t._id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1}),e(g,{span:12},{default:a(()=>[e(s,{label:"供应商",prop:"supplierId"},{default:a(()=>[e(R,{modelValue:n.supplierId,"onUpdate:modelValue":l[6]||(l[6]=t=>n.supplierId=t),placeholder:"请选择供应商",style:{width:"100%"}},{default:a(()=>[(v(!0),x($,null,B(L.value,t=>(v(),Y(S,{key:t._id,label:t.name,value:t._id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(E,{gutter:20},{default:a(()=>[e(g,{span:12},{default:a(()=>[e(s,{label:"入库数量",prop:"quantity"},{default:a(()=>[e(z,{modelValue:n.quantity,"onUpdate:modelValue":l[7]||(l[7]=t=>n.quantity=t),min:1,style:{width:"100%"},onChange:F},null,8,["modelValue"])]),_:1})]),_:1}),e(g,{span:12},{default:a(()=>[e(s,{label:"采购单价",prop:"purchasePrice"},{default:a(()=>[e(z,{modelValue:n.purchasePrice,"onUpdate:modelValue":l[8]||(l[8]=t=>n.purchasePrice=t),precision:2,step:.1,min:0,style:{width:"100%"},onChange:F},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(E,{gutter:20},{default:a(()=>[e(g,{span:12},{default:a(()=>[e(s,{label:"总金额"},{default:a(()=>[e(C,{value:`¥${G.value.toFixed(2)}`,readonly:"",style:{width:"100%"}},null,8,["value"])]),_:1})]),_:1}),e(g,{span:12},{default:a(()=>[e(s,{label:"入库日期",prop:"inboundDate"},{default:a(()=>[e(M,{modelValue:n.inboundDate,"onUpdate:modelValue":l[9]||(l[9]=t=>n.inboundDate=t),type:"date",placeholder:"选择入库日期",style:{width:"100%"},format:"YYYY-MM-DD","value-format":"YYYY-MM-DD"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(s,{label:"备注"},{default:a(()=>[e(C,{modelValue:n.notes,"onUpdate:modelValue":l[10]||(l[10]=t=>n.notes=t),type:"textarea",rows:3,placeholder:"请输入备注信息"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"]),e(A,{modelValue:I.value,"onUpdate:modelValue":l[13]||(l[13]=t=>I.value=t),title:"入库详情",width:"600px"},{default:a(()=>[e(le,{column:2,border:""},{default:a(()=>[e(p,{label:"商品名称"},{default:a(()=>[o(r(i.value.productName),1)]),_:1}),e(p,{label:"品牌"},{default:a(()=>[o(r(i.value.brand),1)]),_:1}),e(p,{label:"规格"},{default:a(()=>[o(r(i.value.specification),1)]),_:1}),e(p,{label:"入库数量"},{default:a(()=>[o(r(i.value.quantity)+" "+r(i.value.unit),1)]),_:1}),e(p,{label:"采购单价"},{default:a(()=>{var t;return[o("¥"+r((t=i.value.purchasePrice)==null?void 0:t.toFixed(2)),1)]}),_:1}),e(p,{label:"总金额"},{default:a(()=>{var t;return[o("¥"+r((t=i.value.totalAmount)==null?void 0:t.toFixed(2)),1)]}),_:1}),e(p,{label:"供应商"},{default:a(()=>[o(r(i.value.supplierName),1)]),_:1}),e(p,{label:"入库日期"},{default:a(()=>[o(r(N(T)(i.value.inboundDate)),1)]),_:1}),e(p,{label:"操作员"},{default:a(()=>[o(r(i.value.operator),1)]),_:1}),e(p,{label:"备注",span:2},{default:a(()=>[o(r(i.value.notes||"无"),1)]),_:1})]),_:1})]),_:1},8,["modelValue"])])}}},Qe=ne(Me,[["__scopeId","data-v-08c9273c"]]);export{Qe as default};
