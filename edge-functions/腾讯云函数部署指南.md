# 腾讯云函数部署指南

## 部署包信息
- 文件名: `scf-deploy.zip`
- 大小: 约 3.4MB
- 包含: 完整的库存管理系统后端代码和依赖

## 部署步骤

### 1. 登录腾讯云控制台
访问 [腾讯云控制台](https://console.cloud.tencent.com/)

### 2. 进入云函数服务
- 在产品列表中找到"云函数 SCF"
- 或直接访问: https://console.cloud.tencent.com/scf

### 3. 创建函数
1. 点击"新建"按钮
2. 选择"自定义创建"
3. 填写基本信息：
   - **函数名称**: `inventory-management-api`
   - **地域**: 选择离你最近的地域（如北京）
   - **运行环境**: `Node.js 18.15`

### 4. 函数配置
1. **函数代码**:
   - 提交方法: 选择"本地上传zip包"
   - 上传 `scf-deploy.zip` 文件
   
2. **高级配置**:
   - **执行方法**: `index.main_handler`
   - **内存**: `128MB`
   - **超时时间**: `30秒`
   - **环境变量**（可选）:
     - `MONGODB_URI`: 你的MongoDB连接字符串（如果需要真实数据库）

### 5. 配置触发器
1. 在函数详情页面，点击"触发器管理"
2. 点击"创建触发器"
3. 选择触发器类型：
   - **API网关触发器**（推荐）
   - 或 **函数URL**（更简单）

#### API网关触发器配置：
- **API类型**: HTTP&HTTPS
- **请求方法**: ANY
- **发布环境**: 发布
- **鉴权方式**: 免鉴权

#### 函数URL配置：
- **认证方式**: 免认证
- **CORS**: 启用

### 6. 测试部署
部署完成后，你会获得一个访问地址，例如：
- API网关: `https://service-xxx.bj.apigw.tencentcs.com/release/`
- 函数URL: `https://xxx.scf.tencentcloudapi.com/`

测试健康检查：
```bash
curl https://your-api-url/api/health
```

预期返回：
```json
{
  "success": true,
  "message": "库存管理系统API运行正常",
  "timestamp": "2025-01-29T15:15:00.000Z",
  "environment": "Tencent Cloud Function"
}
```

## API端点列表

### 商品管理
- `GET /api/products` - 获取商品列表
- `POST /api/products` - 创建商品
- `PUT /api/products/:id` - 更新商品
- `DELETE /api/products/:id` - 删除商品

### 供应商管理
- `GET /api/suppliers` - 获取供应商列表
- `POST /api/suppliers` - 创建供应商
- `PUT /api/suppliers/:id` - 更新供应商
- `DELETE /api/suppliers/:id` - 删除供应商

### 入库管理
- `GET /api/inbound` - 获取入库记录
- `POST /api/inbound` - 创建入库记录

### 出库管理
- `GET /api/outbound` - 获取出库记录
- `POST /api/outbound` - 创建出库记录

## 前端配置更新

部署完成后，需要更新前端的API地址：

1. 修改 `frontend/src/utils/http.js` 中的 `baseURL`：
```javascript
const baseURL = 'https://your-api-url'; // 替换为你的云函数地址
```

2. 重新构建并部署前端应用

## 注意事项

1. **冷启动**: 云函数可能有冷启动延迟，首次请求可能较慢
2. **并发限制**: 默认并发限制为1000，可根据需要调整
3. **日志查看**: 在云函数控制台的"日志查询"中查看运行日志
4. **监控**: 可在"监控信息"中查看函数运行状态和性能指标

## 故障排除

### 常见问题：
1. **函数超时**: 增加超时时间设置
2. **内存不足**: 增加内存配置
3. **依赖问题**: 检查package.json中的依赖版本
4. **CORS错误**: 确保触发器配置了正确的CORS设置

### 查看日志：
在云函数控制台 -> 函数详情 -> 日志查询中查看详细错误信息

## 成本估算

基于当前配置（128MB内存，30秒超时）：
- 免费额度: 每月100万次调用，40万GB-秒
- 超出免费额度后按量计费
- 预计月成本: 小型应用通常在免费额度内

部署完成后，你的库存管理系统后端就可以在腾讯云函数上稳定运行了！